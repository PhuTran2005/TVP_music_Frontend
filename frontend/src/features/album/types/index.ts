import type { Artist } from "@/features/artist/types";
import type { Genre } from "@/features/genre/types";
import { Track } from "@/features/track/types";

export interface Album {
  _id: string;
  title: string;
  slug: string;
  type: "album" | "single" | "ep" | "compilation";
  description?: string;

  // Visuals
  coverImage: string; // Luôn là URL string khi nhận từ API
  themeColor: string; // Hex color

  // Relations (Thường đã được populate)
  artist: Artist; // Backend trả về object Artist đầy đủ
  genres: Genre[]; // Backend trả về mảng Genre đầy đủ

  // Release & Legal
  releaseDate: string; // ISO Date String
  releaseYear: number;
  label?: string;
  copyright?: string;
  upc?: string;
  tags?: string[];
  playCount: number; // Tổng lượt nghe của Album
  likeCount: number; // Số lượng yêu thích
  tracks?: Track[];
  // Stats & Status
  totalTracks: number;
  isPublic: boolean;
  totalDuration: number; // Tổng thời lượng tất cả track trong album (tính bằng giây)
  createdAt: string;
  updatedAt: string;
}

// ==========================================
// 2. INPUTS (Dữ liệu gửi lên API)
// ==========================================

// Base Input cho Form (Khớp với Zod Schema AlbumFormValues)
export interface AlbumFormInput {
  title: string;
  type: "album" | "single" | "ep" | "compilation";
  description?: string;

  coverImage: File | string | null;

  themeColor: string;
  artist: string;
  genreIds: string[];

  releaseDate: string; // YYYY-MM-DD
  isPublic: boolean;

  // New fields
  label?: string;
  copyright?: string;
  upc?: string;
  tags?: string;
}

// Input dùng cho hàm Create (thường giống FormInput)
export type CreateAlbumInput = AlbumFormInput;

// Input dùng cho hàm Update (cần thêm _id để định danh)
export interface UpdateAlbumInput extends Partial<AlbumFormInput> {
  _id: string;
}

// ==========================================
// 3. PARAMS & RESPONSE
// ==========================================

// Params lọc danh sách
export interface AlbumFilterParams {
  page?: number;
  limit?: number;
  keyword?: string;
  artistId?: string;
  genreId?: string;
  year?: number;
  type?: "album" | "single" | "ep" | "compilation" | "all";
  sort?: "newest" | "oldest" | "popular" | "a-z"; // Thêm sort
  isPublic?: boolean; // Admin có thể lọc theo trạng thái
}
